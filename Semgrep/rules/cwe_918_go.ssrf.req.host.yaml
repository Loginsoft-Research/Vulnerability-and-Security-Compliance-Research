rules:
- id: ssrf-req-host
  message: A crafted request directly used without sanitization would lead to SSRF
  languages:
   - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-918: Server-Side Request Forgery"
  patterns:
   - pattern-inside: |
           import ("github.com/stripe/goproxy")
           ...
   - pattern-either:
     - pattern: |
        $REMOTEHOST := ($REQUEST : *http.Request).$ANYTHING
     - pattern: |
        $REMOTEHOST := ($REQUEST : http.Request).$ANYTHING
   - metavariable-regex:
        metavariable: $ANYTHING
        regex: ^(Host)
