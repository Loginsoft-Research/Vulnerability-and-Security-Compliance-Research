rules:
- id: pathtraversal-in-pathjoin
  message: A user supplied URL path is directly used to read the internal file which could lead to path traversal
  languages:
    - typescript
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  patterns:
        - pattern:  |
            $FILEPATH = path.join($WORKDIR, $FILE);
            ...
            $HASFILE = await exists($FILEPATH);
        - pattern-not: |
            $FILEPATH = path.join("...", "...");
            ...
            $HASFILE = await exists($FILEPATH);
