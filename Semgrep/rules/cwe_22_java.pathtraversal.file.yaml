rules:
- id: pathtraversal-in-javaiofile
  message: A user supplied input is directly used to append the file which could lead to path traversal
  languages:
    - java
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  mode: taint
  pattern-sanitizers:
    - patterns:
      - pattern: if(!$FILE.toPath().normalize().startsWith($DESTDIR)) {...}
  pattern-sinks:
    - patterns:
        - pattern-inside: |
            java.io.File $FILE = new java.io.File($DESTDIR + ... + ...);
            ...
            $FILE.getParentFile().mkdirs();
  pattern-sources:
    - patterns:
      - pattern-inside: |
            unzipJar(... , String $DESTDIR, ...){
              ...
            }
