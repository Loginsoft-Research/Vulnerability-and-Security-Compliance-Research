rules:
- id: ssrf-pattern-path
  message: A crafted request directly used in path function without sanitization would lead to SSRF
  languages:
   - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-918: Server-Side Request Forgery"
  patterns:
  - pattern-inside:
      func $HANDLEFILE(..., $R *http.Request){
        ...
      }
  - pattern: |
       pattern.Path($R.$CONTEXT())
  - pattern-not : |
       pattern.Path("...")
