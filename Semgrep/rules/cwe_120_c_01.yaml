rules:
  - id: buffer-copy-without-checking-size-of-input-01
    severity: WARNING
    message: "The use of strcpy without checking of $SINK_VAR input size would lead buffer overflows."
    languages:
      - c
    cwe:
      - "CWE-120: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow')"
    references: https://github.com/moonlight-stream/moonlight-common-c/pull/83/commits
    mode: taint
    pattern-sources:
      - by-side-effect: true
        patterns:
          - pattern: |
              $RETURN_TYPE $FUNC($TYPE $SOURCE_VAR) 
              {
                ...
              }
          - focus-metavariable: $SOURCE_VAR
    pattern-sinks:
      - patterns:
          - pattern-either:
            - pattern: strcpy($SINK_BUF, $SINK_VAR);
          - focus-metavariable: $SINK_VAR
