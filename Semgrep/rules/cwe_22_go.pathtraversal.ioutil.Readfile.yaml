rules:
- id: PathTraversal-ioutil-Readfile
  message: Improper validation in filtering out the path in readfile function.
  languages:
    - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  patterns:
   - pattern-either:
     - pattern: ioutil.ReadFile(fmt.Sprintf(...))
     - pattern: ioutil.ReadFile($FILE)
   - pattern-not: ioutil.ReadFile(fmt.Sprintf(..., "$DIR", "$FILE"))
   - pattern-not: ioutil.ReadFile("...")
   - pattern-not: ioutil.ReadFile(..., "...")
   - pattern-not: ioutil.ReadFile(... + "..." + ...)
   - pattern-not: ioutil.ReadFile($DIR + "...")
   - pattern-not: ioutil.ReadFile($FUNC("..."))
   - pattern-not: ioutil.ReadFile($FUNC(..., "..."))
   - pattern-not: ioutil.ReadFile($FUNC("...", ...))
   - pattern-not: ioutil.ReadFile($FUNC(..., $VAR + "..."))
   - pattern-not: ioutil.ReadFile($FUNC(... + "..."))
   - pattern-not: ioutil.ReadFile($FUNC(... + "..." + ...))
   - pattern-not: ioutil.ReadFile($FUNC($READ(... + "..." + ...)))
   - pattern-not: ioutil.ReadFile($FUNC($READ(... , "...", ...)))
