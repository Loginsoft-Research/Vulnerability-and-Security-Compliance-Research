rules:
- id: pathtraversal-in-decodeURI
  message: A user supplied URL path is directly used to read the internal file which could lead to path traversal
  languages:
    - javascript
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  patterns:
        - pattern:  |
            const $URLPATH = decodeURI($URL)
        - pattern-not: const $URLPATH = decodeURI("...")
        - pattern-not: |
                const $URLPATH = decodeURI($URL)
                ...
                normalize($URLPATH)
