rules:
- id: pathtraversal-getGitRepoPath
  message: Vulnerable to path traversal as the unsanitized user supplied input from URL is directly passed to read the file.
  languages:
    - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  pattern: |
      $REQPATH := strings.ToLower($PATH)
      ...
      $FILE := strings.TrimPrefix($REQPATH, ...)
      ...
      $DIR, ... := getGitRepoPath(...)
