rules:
- id: pathtraversal-in-uncompress
  message: A user supplied file name is directly used to uncompress the file which could lead to path traversal
  languages:
    - java
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  patterns:
    - pattern: (java.io.File $TARFILE) = new java.io.File(...);
    - pattern-not : (java.io.File $TARFILE) = new java.io.File("...");
    - pattern-inside : |
        $TYPE uncompress(...){
          ...
        }
