rules:
- id: pathtraversal-in-zipentry
  message: A user supplied file is directly used in zipentry function which could lead to path traversal
  languages:
    - java
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  patterns:
    - pattern: |
        (java.io.FileOutputStream $FOS) = new FileOutputStream($DESTPATH);
    - pattern-inside: |
        extractJar(...){
          ...
          (java.util.zip.ZipEntry $ENTRY) = ...;
          ...
          (java.io.File $DESTPATH) = new File($DIR, $FILE);
          ...
        }
