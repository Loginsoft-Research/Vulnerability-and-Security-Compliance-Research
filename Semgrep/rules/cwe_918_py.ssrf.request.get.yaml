rules:
- id: python-requests-get
  message: A crafted request directly used in function without sanitization would lead to SSRF
  languages:
   - python
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-918: Server-Side Request Forgery"
  patterns:
  - pattern: |
      requests.get($URL, ...)
  - pattern-not: |
      requests.get($URL, ..., allow_redirects=False)
  - pattern-inside: |
      def $FUNC($URL, ...):
        ...
