rules:
- id: ssrf-url-path
  message: A crafted request directly used in url path without sanitization would lead to SSRF
  languages:
    - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-918: Server-Side Request Forgery"
  patterns:
      - pattern: |
          $URLPATH := $CTX.Req.URL.Path
          ...
          $HASH := $URLPATH[strings.LastIndex($URLPATH, "/")+1:]
