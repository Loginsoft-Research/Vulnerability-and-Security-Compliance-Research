rules:
- id: pathtraversal-joinstr
  message: User supplied input is directly used to read the files which would lead to path traversal.
  languages:
    - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  patterns:
    - pattern: |
        $PATH = $STRING.JoinStr(...)
        ...
        $FILES, ... = ioutil.ReadDir($PATH)
    - pattern-not: $PATH = $STRING.JoinStr("...")
