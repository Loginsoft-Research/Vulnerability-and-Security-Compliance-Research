rules:
- id: pathtraversal-requesturi
  message: A user supplied URI is used to read path without sanitization
  languages:
  - go
  severity: WARNING
  metadata:
    category: security
    cwe:
      - "CWE-22: Path Traversal"
  pattern: |
      $REQPATH := strings.TrimPrefix($REQ.URL.RequestURI(), "/"+$PREFIX)
      ...
      $REQPATH = strings.TrimPrefix($REQPATH, "/")
      ...
      $OPEN, ... := objStore.Open($REQPATH)
