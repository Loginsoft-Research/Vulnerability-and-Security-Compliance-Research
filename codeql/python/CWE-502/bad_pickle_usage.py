import pickle
from urllib.request import url2pathname, urlopen

def _open(resource_url):
    resource_url = normalize_resource_url(resource_url)
    protocol, path_ = split_resource_url(resource_url)

    if protocol is None or protocol.lower() == "nltk":
        return find(path_, path + [""]).open()
    elif protocol.lower() == "file":
        return find(path_, [""]).open()
    else:
        return urlopen(resource_url)

# Flow starts - malicious URL pointing to evil pickle data 
resource_url = "malicious_url"

# Flow continues - urlopen fetches malicious pickle data
opened_resource = _open(resource_url)

# VULNERABILITY: Critical point - unsafe deserialization
# pickle.load will execute the malicious code
resource_val = pickle.load(opened_resource)

